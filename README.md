# å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æå®Œæ•´API MCP æœåŠ¡å™¨

è¿™æ˜¯ä¸€ä¸ªåŸºäºå¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPIçš„MCPï¼ˆModel Context Protocolï¼‰æœåŠ¡å™¨ï¼Œæä¾›å®Œæ•´çš„æƒ…æŠ¥æŸ¥è¯¢åŠŸèƒ½ã€‚æ”¯æŒå¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPIçš„å…¨éƒ¨15ä¸ªå·¥å…·ï¼ŒåŒ…æ‹¬IPåˆ†æã€åŸŸååˆ†æã€æ–‡ä»¶æ£€æµ‹ã€URLæ‰«æã€æ¼æ´æƒ…æŠ¥ç­‰ã€‚

[![Python Version](https://img.shields.io/badge/python-3.8+-blue.svg)](https://python.org)
[![MCP Protocol](https://img.shields.io/badge/MCP-1.9.3-green.svg)](https://modelcontextprotocol.io)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPI](https://img.shields.io/badge/å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPI-å®Œæ•´æ”¯æŒ-red.svg)](https://x.threatbook.com)

## åŠŸèƒ½ç‰¹æ€§

### IPåˆ†æ
- ğŸ” **IPä¿¡èª‰æŸ¥è¯¢**: æŸ¥è¯¢IPåœ°å€çš„å®‰å…¨ä¿¡èª‰ä¿¡æ¯
- ğŸŒ **IPåˆ†æ**: è·å–IPåœ°ç†ä½ç½®ã€ASNä¿¡æ¯ã€å¨èƒç±»å‹ç­‰
- ğŸ“ˆ **IPé«˜çº§æŸ¥è¯¢**: è·å–IPå†å²è§£æè®°å½•ã€ç«¯å£ä¿¡æ¯ç­‰

### åŸŸååˆ†æ
- ğŸŒ **åŸŸååˆ†æ**: è·å–åŸŸåè§£æIPã€Whoisä¿¡æ¯ã€å¨èƒç±»å‹ç­‰
- ğŸ“Š **åŸŸåé«˜çº§æŸ¥è¯¢**: è·å–åŸŸåå†å²Whoisã€å†å²è§£æIPä¿¡æ¯
- ğŸ” **åŸŸåä¸Šä¸‹æ–‡æŸ¥è¯¢**: é’ˆå¯¹æ¶æ„åŸŸåæŸ¥è¯¢ä¸Šä¸‹æ–‡ä¿¡æ¯
- ğŸŒ¿ **å­åŸŸåæŸ¥è¯¢**: è·å–åŸŸåçš„å­åŸŸåä¿¡æ¯

### æ–‡ä»¶åˆ†æ
- ğŸ“„ **æ–‡ä»¶ä¿¡èª‰æŠ¥å‘Š**: è·å–æ–‡ä»¶è¯¦ç»†çš„é™æ€å’ŒåŠ¨æ€åˆ†ææŠ¥å‘Š
- ğŸ”¬ **åç—…æ¯’å¼•æ“æ£€æµ‹**: è·å–æ–‡ä»¶ç»è¿‡22æ¬¾åç—…æ¯’æ‰«æå¼•æ“æ£€æµ‹ç»“æœ
- ğŸ“¤ **æ–‡ä»¶ä¸Šä¼ åˆ†æ**: ä¸Šä¼ æ–‡ä»¶è¿›è¡Œæ²™ç®±åˆ†æ

### URLåˆ†æ
- ğŸŒ **URLæ‰«æ**: å¯¹URLè¿›è¡Œæ‰«æåˆ†æ
- ğŸ“‹ **URLä¿¡èª‰æŠ¥å‘Š**: è·å–URLæ‰«æå¼•æ“æ£€æµ‹ç»“æœ

### æ¼æ´æƒ…æŠ¥
- ğŸ›¡ï¸ **æ¼æ´æƒ…æŠ¥**: è·å–å…¬å¼€æ¼æ´çš„åŸºç¡€ä¿¡æ¯ã€é£é™©è¯„ä¼°ã€PoCç­‰
- ğŸ¯ **äº§å“æ¼æ´åŒ¹é…**: é€šè¿‡å‚å•†äº§å“åŒ¹é…åŠŸèƒ½èšåˆç›¸å…³æ¼æ´

### å¤±é™·æ£€æµ‹
- ğŸš¨ **IOCæ£€æµ‹**: æ£€æµ‹IPåœ°å€æˆ–åŸŸåçš„æ¶æ„å¨èƒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ThreatMCP

# å®‰è£…ä¾èµ–ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„ç²¾ç¡®ä¾èµ–ï¼‰
pip install -r requirements.txt
```

**å½“å‰ä¾èµ–åŒ…ï¼š**
- `mcp` - Model Context Protocolæ ¸å¿ƒåŒ…
- `pydantic` - æ•°æ®éªŒè¯åº“
- `requests` - HTTPè¯·æ±‚åº“

### 2. é…ç½®APIå¯†é’¥

è®¾ç½®å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPIå¯†é’¥ç¯å¢ƒå˜é‡ï¼š

```bash
export THREATBOOK_API_KEY="your_threatbook_api_key_here"
```

### 3. è·å–å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPIå¯†é’¥

1. è®¿é—® [å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æå®˜ç½‘](https://x.threatbook.com)
2. æ³¨å†Œè´¦å·å¹¶ç™»å½•
3. åœ¨APIç®¡ç†é¡µé¢è·å–ä½ çš„APIå¯†é’¥



### 4. å¯åŠ¨æœåŠ¡å™¨

## ğŸ”— é›†æˆä½¿ç”¨

### Claude Desktopé›†æˆ

åœ¨Claude Desktopçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "threatbook": {
      "command": "python",
      "args": ["/path/to/your/ThreatMCP/run_server.py"],
      "env": {
        "THREATBOOK_API_KEY": "your_api_key_here"
      }
    }
  }
}
```

**é…ç½®è¯´æ˜ï¼š**
- `command`: ä½¿ç”¨ `python` å‘½ä»¤
- `args`: ä½¿ç”¨å®Œæ•´ç»å¯¹è·¯å¾„è¿è¡Œ `run_server.py` è„šæœ¬
- `env`: è®¾ç½®å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPIå¯†é’¥ç¯å¢ƒå˜é‡

**æ³¨æ„**: è¯·å°†è·¯å¾„ `/path/to/your/ThreatMCP/run_server.py` æ›¿æ¢ä¸ºæ‚¨å®é™…çš„é¡¹ç›®è·¯å¾„

### å…¶ä»–MCPå®¢æˆ·ç«¯

æœ¬æœåŠ¡å™¨å…¼å®¹æ‰€æœ‰æ”¯æŒMCPåè®®çš„å®¢æˆ·ç«¯ï¼ŒåŒ…æ‹¬ï¼š
- Claude Desktop
- å…¶ä»–AIåŠ©æ‰‹å·¥å…·
- è‡ªå®šä¹‰MCPå®¢æˆ·ç«¯

## ğŸ” å®æˆ˜åº”ç”¨åœºæ™¯(éæƒ³)

### AI é©±åŠ¨çš„ Linux ç³»ç»Ÿåº”æ€¥å“åº”åˆ†æ

ç»“åˆ AI SSH å·¥å…·å’Œå¨èƒæƒ…æŠ¥ï¼Œå¯ä»¥å®ç°æ™ºèƒ½åŒ–çš„ Linux ç³»ç»Ÿå®‰å…¨åº”æ€¥åˆ†æï¼š

#### ğŸš¨ å…¸å‹åº”æ€¥å“åº”æµç¨‹

**1. å¼‚å¸¸å‘ç°é˜¶æ®µ**
```bash
# AI é€šè¿‡ SSH è¿æ¥åˆ°å¯ç–‘ç³»ç»Ÿ
ssh user@suspicious-server

# æ£€æŸ¥ç³»ç»ŸåŸºæœ¬çŠ¶æ€
ps aux | grep -E "(bitcoin|mining|crypto)"
netstat -tulpn | grep LISTEN
```

**2. å¨èƒæƒ…æŠ¥å…³è”åˆ†æ**
- **å¯ç–‘ IP åˆ†æ**: ä½¿ç”¨ `ip_reputation` å’Œ `ip_analysis` å·¥å…·åˆ†æç³»ç»Ÿä¸­å‘ç°çš„å¤–éƒ¨è¿æ¥ IP
- **åŸŸåå¨èƒæ£€æµ‹**: é€šè¿‡ `domain_analysis` æ£€æŸ¥ç³»ç»Ÿ DNS æŸ¥è¯¢è®°å½•ä¸­çš„å¯ç–‘åŸŸå
- **æ–‡ä»¶å“ˆå¸ŒéªŒè¯**: ä½¿ç”¨ `file_analysis` åˆ†æå¯ç–‘æ–‡ä»¶çš„ MD5/SHA256 å“ˆå¸Œå€¼

**3. æ·±åº¦åˆ†æç¤ºä¾‹**

```bash
# å‘ç°å¯ç–‘å¤–è¿ IP: 192.168.1.100
# AI è‡ªåŠ¨è°ƒç”¨å¨èƒæƒ…æŠ¥ API è¿›è¡Œåˆ†æ
```

AI ä¼šè‡ªåŠ¨ï¼š
1. è°ƒç”¨ `ip_reputation` æŸ¥è¯¢è¯¥ IP çš„ä¿¡èª‰ä¿¡æ¯
2. ä½¿ç”¨ `ip_analysis` è·å– IP åœ°ç†ä½ç½®ã€ASNã€å†å²å¨èƒè®°å½•
3. é€šè¿‡ `ioc_detection` æ£€æµ‹æ˜¯å¦ä¸ºå·²çŸ¥çš„å¤±é™·æŒ‡æ ‡

**4. ç»¼åˆå¨èƒè¯„ä¼°**

AI ç»“åˆç³»ç»Ÿä¿¡æ¯å’Œå¨èƒæƒ…æŠ¥ï¼Œæä¾›ï¼š
- ğŸ¯ **å¨èƒç­‰çº§è¯„ä¼°**: åŸºäºå¤šç»´åº¦æƒ…æŠ¥æ•°æ®
- ğŸ“Š **æ”»å‡»é“¾åˆ†æ**: å…³è”åˆ†ææ”»å‡»è€…çš„ TTPs
- ğŸ›¡ï¸ **å¤„ç½®å»ºè®®**: æä¾›å…·ä½“çš„å®‰å…¨åŠ å›ºæªæ–½

#### ğŸ”§ æ”¯æŒçš„åˆ†æåœºæ™¯

| åˆ†æç±»å‹ | ä½¿ç”¨çš„å¨èƒæƒ…æŠ¥å·¥å…· | åº”ç”¨åœºæ™¯ |
|---------|------------------|----------|
| **ç½‘ç»œè¿æ¥åˆ†æ** | `ip_reputation`, `ip_analysis` | æ£€æµ‹æ¶æ„å¤–è¿ã€C&C é€šä¿¡ |
| **DNS æŸ¥è¯¢åˆ†æ** | `domain_analysis`, `domain_context` | å‘ç°æ¶æ„åŸŸåã€DGA åŸŸå |
| **æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥** | `file_analysis`, `file_multiengines` | æ£€æµ‹æœ¨é©¬ã€åé—¨ã€æŒ–çŸ¿ç¨‹åº |
| **Web è®¿é—®åˆ†æ** | `url_scan`, `url_report` | åˆ†æå¯ç–‘ URL è®¿é—®è®°å½• |
| **æ¼æ´é£é™©è¯„ä¼°** | `vulnerability`, `vuln_match` | ç³»ç»Ÿæ¼æ´é£é™©è¯„ä¼° |

#### ğŸ’¡ æ™ºèƒ½åŒ–ä¼˜åŠ¿

- **è‡ªåŠ¨åŒ–åˆ†æ**: AI è‡ªåŠ¨æ‰§è¡Œç³»ç»Ÿæ£€æŸ¥å’Œå¨èƒæƒ…æŠ¥æŸ¥è¯¢
- **å…³è”åˆ†æ**: å°†ç³»ç»Ÿæ—¥å¿—ä¸å…¨çƒå¨èƒæƒ…æŠ¥è¿›è¡Œå…³è”
- **å®æ—¶å“åº”**: å¿«é€Ÿè¯†åˆ«å¨èƒå¹¶æä¾›å¤„ç½®å»ºè®®
- **çŸ¥è¯†ç§¯ç´¯**: åŸºäºå†å²æ¡ˆä¾‹ä¸æ–­ä¼˜åŒ–åˆ†æç­–ç•¥

#### ğŸ¯ å®é™…åº”ç”¨ä»·å€¼

1. **æå‡å“åº”é€Ÿåº¦**: ä»å°æ—¶çº§ç¼©çŸ­åˆ°åˆ†é’Ÿçº§
2. **é™ä½è¯¯æŠ¥ç‡**: åŸºäºæƒå¨å¨èƒæƒ…æŠ¥æºè¿›è¡ŒéªŒè¯
3. **æ ‡å‡†åŒ–æµç¨‹**: ç¡®ä¿åº”æ€¥å“åº”çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§
4. **çŸ¥è¯†ä¼ æ‰¿**: AI åŠ©æ‰‹å¯ä»¥ä¼ æ‰¿ä¸“å®¶ç»éªŒ

> **æ³¨æ„**: æ­¤åŠŸèƒ½éœ€è¦é…åˆæ”¯æŒ SSH çš„ AI å·¥å…·ä½¿ç”¨ï¼Œå¦‚ Claude Desktop é…åˆ SSH MCP æœåŠ¡å™¨ç­‰ã€‚

## ğŸ› ï¸ å®Œæ•´APIå·¥å…·é›†

æœ¬MCPæœåŠ¡å™¨æä¾›å¾®æ­¥åœ¨çº¿å¨èƒåˆ†æAPIçš„**å®Œæ•´15ä¸ªå·¥å…·**ï¼Œè¦†ç›–æ‰€æœ‰å¨èƒæƒ…æŠ¥åˆ†æåœºæ™¯ï¼š

### IPç›¸å…³å·¥å…·

1. **ip_reputation** - IPä¿¡èª‰æŸ¥è¯¢
2. **ip_analysis** - IPåˆ†æ
3. **ip_advanced** - IPé«˜çº§æŸ¥è¯¢
4. **ioc_detection** - å¤±é™·æ£€æµ‹

### åŸŸåç›¸å…³å·¥å…·

5. **domain_analysis** - åŸŸååˆ†æ
6. **domain_advanced** - åŸŸåé«˜çº§æŸ¥è¯¢
7. **domain_context** - åŸŸåä¸Šä¸‹æ–‡æŸ¥è¯¢
8. **subdomain** - å­åŸŸåæŸ¥è¯¢

### æ–‡ä»¶ç›¸å…³å·¥å…·

9. **file_analysis** - æ–‡ä»¶ä¿¡èª‰æŠ¥å‘Š
10. **file_multiengines** - æ–‡ä»¶åç—…æ¯’å¼•æ“æ£€æµ‹
11. **file_upload** - æäº¤æ–‡ä»¶åˆ†æ

### URLç›¸å…³å·¥å…·

12. **url_scan** - æäº¤URLåˆ†æ
13. **url_report** - URLä¿¡èª‰æŠ¥å‘Š

### æ¼æ´ç›¸å…³å·¥å…·

14. **vulnerability** - æ¼æ´æƒ…æŠ¥
15. **vuln_match** - äº§å“æ¼æ´åŒ¹é…



## ğŸ—ï¸ é¡¹ç›®æ¶æ„


### é¡¹ç›®ç»“æ„

```
ThreatMCP/
â”œâ”€â”€ threatbook_mcp/              # æ ¸å¿ƒåŒ…ç›®å½•
â”‚   â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â”‚   â”œâ”€â”€ server.py                # MCPæœåŠ¡å™¨æ ¸å¿ƒ
â”‚   â”œâ”€â”€ response_handler.py      # ç»Ÿä¸€å“åº”å¤„ç†
â”‚   â”œâ”€â”€ ip_reputation.py         # IPä¿¡èª‰æŸ¥è¯¢
â”‚   â”œâ”€â”€ ip_analysis.py           # IPåˆ†æ
â”‚   â”œâ”€â”€ ip_advanced.py           # IPé«˜çº§æŸ¥è¯¢
â”‚   â”œâ”€â”€ ioc_detection.py         # å¤±é™·æ£€æµ‹
â”‚   â”œâ”€â”€ domain_analysis.py       # åŸŸååˆ†æ
â”‚   â”œâ”€â”€ domain_advanced.py       # åŸŸåé«˜çº§æŸ¥è¯¢
â”‚   â”œâ”€â”€ domain_context.py        # åŸŸåä¸Šä¸‹æ–‡æŸ¥è¯¢
â”‚   â”œâ”€â”€ subdomain.py             # å­åŸŸåæŸ¥è¯¢
â”‚   â”œâ”€â”€ file_analysis.py         # æ–‡ä»¶ä¿¡èª‰æŠ¥å‘Š
â”‚   â”œâ”€â”€ file_multiengines.py     # æ–‡ä»¶åç—…æ¯’æ£€æµ‹
â”‚   â”œâ”€â”€ file_upload.py           # æ–‡ä»¶ä¸Šä¼ åˆ†æ
â”‚   â”œâ”€â”€ url_scan.py              # URLæ‰«æ
â”‚   â”œâ”€â”€ url_report.py            # URLä¿¡èª‰æŠ¥å‘Š
â”‚   â”œâ”€â”€ vulnerability.py         # æ¼æ´æƒ…æŠ¥
â”‚   â””â”€â”€ vuln_match.py            # äº§å“æ¼æ´åŒ¹é…
â”œâ”€â”€ run_server.py                # ğŸš€ æœåŠ¡å™¨å¯åŠ¨è„šæœ¬ï¼ˆä¸»å…¥å£ï¼‰
â”œâ”€â”€ requirements.txt             # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â””â”€â”€ config_example.json          # Claude Desktopé…ç½®ç¤ºä¾‹
```

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueæˆ–è”ç³»å¼€å‘è€…ã€‚